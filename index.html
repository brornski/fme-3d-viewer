<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Facegenics Midface Expander (FME) | Team Dental</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --ivory: #FAF9F6;
            --obsidian: #0D0D0D;
            --titanium: #8A8D90;
            --gold: #A0CBE8;
            --gold-light: #C4DFF2;
            --slate: #2A2D32;
            --cream: #F5F3EE;
            --team-blue: #4A9FD4;
            --team-blue-dark: #3B82C4;
            --team-blue-light: #87CEEB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            overscroll-behavior: none;
            -webkit-overscroll-behavior: none;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--obsidian);
            color: var(--ivory);
            overflow-x: hidden;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            -webkit-tap-highlight-color: transparent;
        }

        /* Touch-optimized interactive elements */
        a, button, .cta-button, .nav-cta, .download-model-btn {
            touch-action: manipulation;
        }

        /* Touch feedback — subtle scale on press */
        @media (hover: none) and (pointer: coarse) {
            .cta-button:active,
            .nav-cta:active {
                transform: scale(0.97);
                opacity: 0.9;
            }
            .download-model-btn:active {
                opacity: 0.7;
            }
            .footer-links a:active {
                opacity: 0.6;
            }
        }

        /* WebKit scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: var(--obsidian);
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        /* Noise texture removed — 0.03 opacity was invisible but cost GPU paint every frame */

        /* Loading screen */
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--obsidian);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 1.2s cubic-bezier(0.16, 1, 0.3, 1);
            -webkit-transition: opacity 1.2s cubic-bezier(0.16, 1, 0.3, 1);
        }

        #loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loader-wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        .loader-logo {
            padding: 15px 30px;
            background: linear-gradient(180deg, var(--team-blue-dark) 0%, var(--team-blue-light) 100%);
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(59, 130, 196, 0.25);
        }

        .loader-logo span {
            font-family: 'Arial', sans-serif;
            font-size: 1.1rem;
            font-weight: 300;
            letter-spacing: 0.05em;
            color: white;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 1px solid rgba(160, 203, 232, 0.2);
            border-top-color: var(--gold);
            border-radius: 50%;
            animation: spin 1.2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loader-text {
            font-size: 0.75rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--titanium);
        }

        /* Cinematic intro animations — slow, buttery fade-in */
        .intro-hidden {
            opacity: 0 !important;
            transform: translateY(50px) !important;
            transition: opacity 2.2s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 2.2s cubic-bezier(0.16, 1, 0.3, 1) !important;
        }

        .intro-hidden.intro-from-top {
            transform: translateY(-20px) !important;
            transition: opacity 1.8s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1.8s cubic-bezier(0.16, 1, 0.3, 1) !important;
        }

        .intro-hidden.intro-scale {
            transform: scale(0.95) translateY(20px) !important;
            transition: opacity 2.4s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 2.4s cubic-bezier(0.16, 1, 0.3, 1) !important;
        }

        .intro-visible {
            opacity: 1 !important;
            transform: translateY(0) scale(1) !important;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1.5rem 3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: linear-gradient(to bottom, rgba(13, 13, 13, 0.97) 0%, rgba(13, 13, 13, 0.8) 60%, transparent 100%);
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
        }

        .nav-logo-box {
            padding: 8px 16px;
            background: linear-gradient(180deg, var(--team-blue-dark) 0%, var(--team-blue-light) 100%);
            border-radius: 6px;
        }

        .nav-logo-box span {
            font-family: 'Arial', sans-serif;
            font-size: 0.9rem;
            font-weight: 300;
            letter-spacing: 0.05em;
            color: white;
        }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            list-style: none;
        }

        .nav-links a {
            font-size: 0.8rem;
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--titanium);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--ivory);
        }

        .nav-cta {
            padding: 0.6rem 1.3rem;
            background: linear-gradient(135deg, var(--team-blue-dark) 0%, var(--team-blue) 100%);
            border: none;
            color: white;
            font-family: 'Inter', sans-serif;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        box-shadow 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border-radius: 6px;
            box-shadow: 0 4px 16px rgba(59, 130, 196, 0.25);
        }

        .nav-cta:hover {
            background: linear-gradient(135deg, #4A9FD4 0%, #5BB5E8 100%);
            transform: translateY(-1px);
            box-shadow:
                0 0 20px rgba(74, 159, 212, 0.5),
                0 0 50px rgba(74, 159, 212, 0.25),
                0 8px 24px rgba(59, 130, 196, 0.4);
        }

        /* Scroll indicator */
        .scroll-indicator {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            z-index: 100;
            opacity: 0;
            transition: opacity 1s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .scroll-indicator.intro-ready {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .scroll-indicator.hidden {
            opacity: 0 !important;
            pointer-events: none;
            transform: translateX(-50%) translateY(20px) !important;
        }

        .scroll-indicator span {
            font-size: 0.65rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--titanium);
        }

        .scroll-arrow {
            width: 24px;
            height: 24px;
            border-right: 1px solid var(--gold);
            border-bottom: 1px solid var(--gold);
            transform: rotate(45deg);
            animation: scrollBounce 2s ease infinite;
        }

        @keyframes scrollBounce {
            0%, 100% { transform: rotate(45deg) translateY(0); opacity: 1; }
            50% { transform: rotate(45deg) translateY(8px); opacity: 0.5; }
        }

        /* Fixed 3D Canvas - stays in center of viewport */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            height: 100dvh;
            z-index: 1;
            pointer-events: none;
            opacity: 0;
            transform: scale(0.85);
            transition: opacity 3s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 3s cubic-bezier(0.16, 1, 0.3, 1);
            -webkit-transition: opacity 3s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 3s cubic-bezier(0.16, 1, 0.3, 1);
            will-change: opacity, transform;
        }

        #canvas-container.loaded {
            opacity: 1;
            transform: scale(1);
            transition: opacity 3s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        #canvas-container.loaded.exit {
            opacity: 0;
            transform: scale(0.95) translateY(20px);
            transition: opacity 0.8s cubic-bezier(0.33, 1, 0.68, 1),
                        transform 0.8s cubic-bezier(0.33, 1, 0.68, 1);
        }

        #model-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 500px;
            height: 500px;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle, rgba(255, 255, 255, 0.06) 0%, rgba(255, 255, 255, 0.02) 30%, transparent 60%);
            border-radius: 50%;
            pointer-events: none;
        }

        /* Scroll container - creates scroll height */
        .scroll-container {
            position: relative;
            z-index: 10;
        }

        /* Scroll sections - each triggers different content */
        .scroll-section {
            min-height: 100vh;
            min-height: 100dvh;
            display: flex;
            align-items: center;
            padding: 0 8%;
            position: relative;
        }

        /* Content panels that slide in */
        .content-panel {
            max-width: 480px;
            opacity: 0;
            transition: opacity 0.8s cubic-bezier(0.33, 1, 0.68, 1),
                        transform 0.8s cubic-bezier(0.33, 1, 0.68, 1);
            -webkit-transition: opacity 0.8s cubic-bezier(0.33, 1, 0.68, 1),
                                transform 0.8s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .content-panel.from-left {
            transform: translateX(-40px);
        }

        .content-panel.from-right {
            transform: translateX(40px);
            margin-left: auto;
            text-align: right;
        }

        .content-panel.visible {
            opacity: 1;
            transform: translateX(0);
        }

        /* Staggered child animations — GPU-only properties, easeOutCubic, tight 80ms stagger */
        .content-panel > * {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s cubic-bezier(0.33, 1, 0.68, 1),
                        transform 0.6s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .content-panel.visible > *:nth-child(1) { opacity: 1; transform: translateY(0); transition-delay: 0.05s; }
        .content-panel.visible > *:nth-child(2) { opacity: 1; transform: translateY(0); transition-delay: 0.13s; }
        .content-panel.visible > *:nth-child(3) { opacity: 1; transform: translateY(0); transition-delay: 0.21s; }
        .content-panel.visible > *:nth-child(4) { opacity: 1; transform: translateY(0); transition-delay: 0.29s; }
        .content-panel.visible > *:nth-child(5) { opacity: 1; transform: translateY(0); transition-delay: 0.37s; }
        .content-panel.visible > *:nth-child(6) { opacity: 1; transform: translateY(0); transition-delay: 0.45s; }

        /* Benefits list — GPU-only, tight stagger */
        .benefits-list li {
            opacity: 0;
            transform: translateX(-12px);
            transition: opacity 0.45s cubic-bezier(0.33, 1, 0.68, 1),
                        transform 0.45s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .from-right .benefits-list li {
            transform: translateX(12px);
        }

        .content-panel.visible .benefits-list li:nth-child(1) { opacity: 1; transform: translateX(0); transition-delay: 0.25s; }
        .content-panel.visible .benefits-list li:nth-child(2) { opacity: 1; transform: translateX(0); transition-delay: 0.33s; }
        .content-panel.visible .benefits-list li:nth-child(3) { opacity: 1; transform: translateX(0); transition-delay: 0.41s; }
        .content-panel.visible .benefits-list li:nth-child(4) { opacity: 1; transform: translateX(0); transition-delay: 0.49s; }
        .content-panel.visible .benefits-list li:nth-child(5) { opacity: 1; transform: translateX(0); transition-delay: 0.57s; }

        /* Doctors — GPU-only, gentle entrance */
        .doctors-inline .doctor-mini {
            opacity: 0;
            transform: translateY(15px);
            transition: opacity 0.5s cubic-bezier(0.33, 1, 0.68, 1),
                        transform 0.5s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .content-panel.visible .doctors-inline .doctor-mini:nth-child(1) { opacity: 1; transform: translateY(0); transition-delay: 0.3s; }
        .content-panel.visible .doctors-inline .doctor-mini:nth-child(2) { opacity: 1; transform: translateY(0); transition-delay: 0.4s; }

        /* Locations — GPU-only, tight cascade */
        .locations-mini .location-mini {
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.4s cubic-bezier(0.33, 1, 0.68, 1),
                        transform 0.4s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .content-panel.visible .locations-mini .location-mini:nth-child(1) { opacity: 1; transform: translateY(0); transition-delay: 0.35s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(2) { opacity: 1; transform: translateY(0); transition-delay: 0.43s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(3) { opacity: 1; transform: translateY(0); transition-delay: 0.51s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(4) { opacity: 1; transform: translateY(0); transition-delay: 0.59s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(5) { opacity: 1; transform: translateY(0); transition-delay: 0.67s; }

        /* Hero intro — wider child stagger, longer transitions for cinematic feel */
        .section-hero .content-panel.visible > * {
            transition: opacity 1.2s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1.2s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .section-hero .content-panel.visible > *:nth-child(1) { transition-delay: 0.1s; }
        .section-hero .content-panel.visible > *:nth-child(2) { transition-delay: 0.4s; }
        .section-hero .content-panel.visible > *:nth-child(3) { transition-delay: 0.75s; }
        .section-hero .content-panel.visible > *:nth-child(4) { transition-delay: 1.1s; }

        /* Section 1 - Hero */
        .section-hero {
            min-height: 100vh;
            min-height: 100dvh;
        }

        .hero-eyebrow {
            font-size: 0.75rem;
            letter-spacing: 0.4em;
            text-transform: uppercase;
            color: var(--gold);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-weight: 600;
        }

        .hero-eyebrow::before {
            content: '';
            width: 40px;
            height: 1px;
            background: var(--gold);
        }

        .from-right .hero-eyebrow {
            justify-content: flex-end;
        }

        .from-right .hero-eyebrow::before {
            order: 2;
        }

        .content-panel h1 {
            font-family: 'Inter', sans-serif;
            font-size: clamp(3.2rem, 7vw, 5.5rem);
            font-weight: 800;
            line-height: 1.02;
            letter-spacing: -0.045em;
            margin-bottom: 1.25rem;
        }

        .content-panel h1 em,
        .content-panel h2 em {
            font-style: normal;
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .content-panel p {
            font-size: 1.05rem;
            line-height: 1.75;
            color: var(--ivory);
            margin-bottom: 1.5rem;
            font-weight: 400;
            letter-spacing: 0.005em;
            opacity: 0.7;
        }

        .content-panel h2 {
            font-family: 'Inter', sans-serif;
            font-size: clamp(2.6rem, 5.5vw, 4rem);
            font-weight: 800;
            line-height: 1.08;
            letter-spacing: -0.04em;
            margin-bottom: 1rem;
        }

        .content-panel h3 {
            font-family: 'Inter', sans-serif;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: 700;
            letter-spacing: -0.03em;
            margin-bottom: 1rem;
            color: var(--ivory);
        }

        /* Benefits list */
        .benefits-list {
            list-style: none;
        }

        .benefits-list li {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.8rem;
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--ivory);
            opacity: 0.85;
            letter-spacing: 0.02em;
            transition: color 0.3s ease;
        }

        .from-right .benefits-list li {
            justify-content: flex-end;
        }

        .benefits-list li::before {
            content: '';
            width: 20px;
            height: 1px;
            background: var(--gold);
            flex-shrink: 0;
        }

        .from-right .benefits-list li::before {
            order: 2;
        }

        /* Badge */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: linear-gradient(135deg, var(--team-blue-dark) 0%, var(--team-blue) 100%);
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: white;
            margin-bottom: 1rem;
        }

        .badge::before {
            content: '';
            width: 5px;
            height: 5px;
            background: var(--gold);
            border-radius: 50%;
            animation: pulse 2s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* CTA Button */
        .cta-button {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--team-blue-dark) 0%, var(--team-blue) 100%);
            color: white;
            text-decoration: none;
            font-size: 0.85rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            font-weight: 700;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        box-shadow 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border: none;
            cursor: pointer;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(59, 130, 196, 0.3);
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            width: 6px;
            height: 6px;
            background: var(--gold);
            border-radius: 50%;
            animation: pulse 2s ease infinite;
            flex-shrink: 0;
        }

        .cta-button:hover {
            background: linear-gradient(135deg, #4A9FD4 0%, #5BB5E8 100%);
            transform: translateY(-2px);
            box-shadow:
                0 0 20px rgba(74, 159, 212, 0.5),
                0 0 50px rgba(74, 159, 212, 0.25),
                0 8px 24px rgba(59, 130, 196, 0.4);
        }

        .cta-button svg {
            width: 16px;
            height: 16px;
        }

        /* Doctor cards inline */
        .doctors-inline {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .from-right .doctors-inline {
            justify-content: flex-end;
        }

        .doctor-mini {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .from-right .doctor-mini {
            flex-direction: row-reverse;
        }

        .doctor-mini-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            color: var(--obsidian);
        }

        .doctor-mini-info h4 {
            font-family: 'Inter', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            letter-spacing: -0.01em;
        }

        .doctor-mini-info span {
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--gold);
        }

        /* Doctors section - centered */
        .section-doctors {
            justify-content: center;
            text-align: center;
        }

        .section-doctors .content-panel {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .section-doctors .content-panel.from-left {
            transform: translateY(30px);
        }

        .section-doctors .content-panel.visible {
            transform: translateY(0);
        }

        .section-doctors .hero-eyebrow {
            justify-content: center;
        }

        .section-doctors .doctors-inline {
            justify-content: center;
        }

        .section-doctors .doctor-mini-info span {
            color: #C9A962;
        }

        .section-doctors .doctor-mini-avatar {
            background: linear-gradient(135deg, #C9A962 0%, #E8D5A3 100%);
        }

        .section-doctors .hero-eyebrow::before {
            background: #C9A962;
        }

        /* Final CTA section - smooth gradient from black to gray */
        .section-cta {
            background: linear-gradient(to bottom,
                var(--obsidian) 0%,
                var(--slate) 50%,
                var(--slate) 100%);
            justify-content: center;
            text-align: center;
        }

        .section-cta .content-panel {
            max-width: 600px;
            text-align: center;
        }

        .section-cta .content-panel.from-left {
            transform: translateY(30px);
        }

        .section-cta .content-panel.visible {
            transform: translateY(0);
        }

        /* ========================================
           PINNED SCROLL-DRIVEN SECTIONS
           Tall sections with sticky content.
           JS reveals each [data-reveal] item
           based on scroll progress through section.
           ======================================== */
        .section-pinned {
            display: block;
            padding: 0;
            min-height: auto;
        }

        .pin-wrap {
            position: sticky;
            top: 0;
            height: 100vh;
            height: 100dvh;
            display: flex;
            align-items: center;
            padding: 0 8%;
        }

        /* Panel inside pinned section — JS drives [data-reveal] items directly */
        .section-pinned .content-panel {
            opacity: 1 !important;
            transform: none !important;
            transition: none !important;
        }

        /* Non-[data-reveal] children (e.g. <ul> wrapper): always visible.
           !important needed to beat .content-panel > * { opacity: 0 } */
        .section-pinned .content-panel > *:not([data-reveal]) {
            opacity: 1 !important;
            transform: none !important;
            transition: none !important;
        }

        /* [data-reveal] items: JS sets inline styles to control opacity/transform.
           Disable CSS transitions so JS changes apply instantly.
           Do NOT use !important here — inline styles must win. */
        .section-pinned .benefits-list li,
        .section-pinned .doctors-inline .doctor-mini {
            transition: none;
        }

        /* Locations grid */
        .locations-mini {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
            text-align: left;
        }

        .location-mini {
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            font-size: 0.8rem;
            transition: border-color 0.3s ease, background 0.3s ease;
        }

        .location-mini:hover {
            border-color: rgba(74, 159, 212, 0.3);
            background: rgba(74, 159, 212, 0.04);
        }

        .location-mini h5 {
            color: var(--team-blue);
            font-family: 'Inter', sans-serif;
            font-size: 1.05rem;
            font-weight: 700;
            letter-spacing: -0.01em;
            margin-bottom: 0.25rem;
        }

        .location-mini span {
            color: var(--titanium);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .location-mini a {
            color: var(--titanium);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .location-mini a:hover {
            color: var(--team-blue);
        }

        /* Download button */
        .download-model-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.2rem;
            border: 1px solid rgba(160, 203, 232, 0.3);
            border-radius: 6px;
            color: var(--gold);
            text-decoration: none;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            transition: opacity 0.3s cubic-bezier(0.33, 1, 0.68, 1),
                        background 0.3s cubic-bezier(0.33, 1, 0.68, 1),
                        color 0.3s cubic-bezier(0.33, 1, 0.68, 1),
                        border-color 0.3s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .download-model-btn:hover {
            background: var(--gold);
            color: var(--obsidian);
            border-color: var(--gold);
        }

        /* Footer */
        footer {
            background: var(--slate);
            padding: 4rem 8% 2rem;
            position: relative;
            z-index: 20;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 3rem;
            margin-bottom: 3rem;
            padding-bottom: 3rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-logo {
            padding: 10px 20px;
            background: linear-gradient(180deg, var(--team-blue-dark) 0%, var(--team-blue-light) 100%);
            border-radius: 6px;
        }

        .footer-logo span {
            font-family: 'Arial', sans-serif;
            font-size: 1rem;
            font-weight: 300;
            letter-spacing: 0.05em;
            color: white;
        }

        .footer-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .footer-links a {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--titanium);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--team-blue);
        }

        .footer-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-bottom p {
            font-size: 0.75rem;
            color: var(--titanium);
        }

        /* ========================================
           MOBILE — phones ≤768px
           Apple-inspired: safe areas, fluid type,
           proper touch targets, smooth gradients
           ======================================== */
        @media (max-width: 768px) {
            /* Nav — safe area for notch/Dynamic Island */
            nav {
                padding: 1rem 1.5rem;
                padding-top: max(1rem, env(safe-area-inset-top));
                padding-left: max(1.5rem, env(safe-area-inset-left));
                padding-right: max(1.5rem, env(safe-area-inset-right));
                background: rgba(13, 13, 13, 0.97);
            }

            .nav-links { display: none; }

            .nav-cta {
                min-height: 44px;
                display: inline-flex;
                align-items: center;
                padding: 0.6rem 1.2rem;
                font-size: 0.72rem;
            }

            /* Sections — full viewport height */
            .scroll-section {
                min-height: 100vh;
                min-height: 100dvh;
                padding: 0;
                display: flex;
                flex-direction: column;
                justify-content: flex-end;
                align-items: stretch;
            }

            .section-hero { justify-content: flex-end; }

            /* Pinned sections on mobile */
            .section-pinned {
                display: block;
                padding: 0;
                min-height: auto !important;
            }

            .pin-wrap {
                align-items: flex-end;
            }

            .section-pinned .content-panel {
                max-width: 100%;
                background: linear-gradient(to bottom,
                    rgba(13, 13, 13, 0) 0px,
                    rgba(13, 13, 13, 0.4) 24px,
                    rgba(13, 13, 13, 0.75) 48px,
                    rgba(13, 13, 13, 0.92) 72px,
                    rgba(13, 13, 13, 1) 96px);
                padding: 5.5rem 7% 2.5rem;
                padding-bottom: max(2.5rem, env(safe-area-inset-bottom));
                margin: 0;
                text-align: center;
            }

            /* Content panels — smoother multi-stop gradient */
            .content-panel {
                max-width: 100%;
                background: linear-gradient(to bottom,
                    rgba(13, 13, 13, 0) 0px,
                    rgba(13, 13, 13, 0.4) 24px,
                    rgba(13, 13, 13, 0.75) 48px,
                    rgba(13, 13, 13, 0.92) 72px,
                    rgba(13, 13, 13, 1) 96px);
                padding: 5.5rem 7% 2.5rem;
                padding-bottom: max(2.5rem, env(safe-area-inset-bottom));
                margin: 0;
                text-align: center;
            }

            .content-panel.from-left,
            .content-panel.from-right {
                transform: translateY(30px);
                opacity: 0;
                margin: 0;
            }

            /* Pinned panels must stay visible — override from-left/from-right hiding */
            .section-pinned .content-panel.from-left,
            .section-pinned .content-panel.from-right {
                opacity: 1;
                transform: none;
            }

            .content-panel.visible {
                transform: translateY(0);
                opacity: 1;
            }

            .content-panel.from-right { text-align: center; }

            /* Typography — fluid clamp, tighter tracking for Inter */
            .content-panel h1 {
                font-size: clamp(2.4rem, 9vw, 3.2rem);
                letter-spacing: -0.04em;
                margin-bottom: 1.25rem;
            }

            .content-panel h2 {
                font-size: clamp(2rem, 7.5vw, 2.6rem);
                letter-spacing: -0.035em;
                margin-bottom: 1rem;
            }

            .content-panel h3 {
                font-size: clamp(1.5rem, 5.5vw, 1.9rem);
                letter-spacing: -0.02em;
                margin-bottom: 0.75rem;
            }

            .content-panel p {
                font-size: clamp(0.95rem, 3.8vw, 1.05rem);
                line-height: 1.65;
                color: var(--titanium);
                max-width: 88%;
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 1.5rem;
            }

            /* Eyebrow — centered, no bar */
            .hero-eyebrow {
                justify-content: center;
                margin-bottom: 0.75rem;
                font-size: clamp(0.65rem, 2.5vw, 0.75rem);
            }
            .hero-eyebrow::before { display: none; }
            .from-right .hero-eyebrow { justify-content: center; }

            /* Benefits list — centered, proper spacing */
            .benefits-list {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
            }

            .benefits-list li {
                justify-content: center;
                font-size: clamp(0.9rem, 3.5vw, 1.05rem);
                margin-bottom: 0.5rem;
            }

            .from-right .benefits-list li { justify-content: center; }
            .benefits-list li::before { width: 16px; }
            .from-right .benefits-list li::before { order: 0; }

            /* Badge — centered */
            .badge {
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 1.25rem;
            }

            /* Doctors — vertical stack */
            .doctors-inline {
                flex-direction: column;
                align-items: center;
                gap: 1.5rem;
                margin-top: 2rem;
            }

            .from-right .doctors-inline { justify-content: center; }

            .doctor-mini {
                flex-direction: column;
                text-align: center;
                gap: 0.75rem;
            }

            .from-right .doctor-mini { flex-direction: column; }

            .doctor-mini-avatar {
                width: 64px;
                height: 64px;
                font-size: 1.1rem;
            }

            .doctor-mini-info h4 { font-size: 1.1rem; }

            /* Doctors section — centered */
            .section-doctors { justify-content: center; }
            .section-doctors .content-panel {
                background: transparent;
                text-align: center;
            }

            /* CTA section */
            .section-cta {
                justify-content: center;
                align-items: center;
                padding: 0;
            }

            .section-cta .content-panel {
                background: transparent;
                text-align: center;
                padding: 3rem 7%;
            }

            /* Locations — 2-col grid, matching desktop colors */
            .locations-mini {
                grid-template-columns: 1fr 1fr;
                gap: 0.75rem;
                margin-top: 1.5rem;
                text-align: left;
            }

            .location-mini {
                padding: 0.85rem;
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 6px;
            }

            .location-mini h5 {
                color: var(--team-blue);
                font-size: clamp(0.95rem, 3.5vw, 1.1rem);
                font-weight: 600;
            }

            .location-mini span,
            .location-mini a {
                color: var(--titanium);
                font-size: 0.78rem;
            }

            /* CTA Button — Apple HIG 44px min, centered */
            .cta-button {
                padding: 1.1rem 2.5rem;
                min-height: 48px;
                font-size: 0.82rem;
                width: 100%;
                max-width: 300px;
                justify-content: center;
                border-radius: 8px;
            }

            /* Download button — hidden on mobile */
            .download-model-btn { display: none; }

            /* Model glow — repositioned for upper viewport */
            #model-glow {
                top: 28%;
                width: 300px;
                height: 300px;
            }

            /* Footer — safe area bottom padding */
            footer {
                padding: 3rem 7% 1.5rem;
                padding-bottom: max(1.5rem, env(safe-area-inset-bottom));
            }

            .footer-content {
                flex-direction: column;
                align-items: center;
                text-align: center;
                gap: 2rem;
            }

            .footer-links {
                flex-wrap: wrap;
                justify-content: center;
                gap: 1rem 1.5rem;
            }

            .footer-links a {
                min-height: 44px;
                display: inline-flex;
                align-items: center;
            }

            .footer-bottom {
                flex-direction: column;
                text-align: center;
            }

            /* Scroll indicator — safe area aware */
            .scroll-indicator {
                bottom: max(25px, env(safe-area-inset-bottom));
            }

            .scroll-indicator span {
                font-size: 0.6rem;
                letter-spacing: 0.25em;
            }
        }

        /* Small phones (iPhone SE, older devices ≤375px) */
        @media (max-width: 375px) {
            .content-panel {
                padding: 4.5rem 5% 2rem;
            }

            .content-panel h1 {
                font-size: clamp(2rem, 8.5vw, 2.6rem);
            }

            .content-panel h2 {
                font-size: clamp(1.7rem, 7vw, 2.2rem);
            }

            .locations-mini {
                grid-template-columns: 1fr;
                gap: 0.6rem;
            }

            .cta-button {
                max-width: 260px;
                padding: 1rem 2rem;
                font-size: 0.78rem;
            }

            .nav-logo-box { padding: 6px 12px; }
            .nav-logo-box span { font-size: 0.8rem; }
        }

        /* Landscape phones — prevent content from being too tall */
        @media (max-width: 768px) and (orientation: landscape) {
            .scroll-section {
                min-height: auto;
                padding: 2rem 5%;
            }

            .content-panel {
                padding: 2rem 5% 1.5rem;
                background: rgba(13, 13, 13, 0.95);
            }

            .content-panel h1 { font-size: clamp(1.8rem, 5vw, 2.4rem); }
            .content-panel h2 { font-size: clamp(1.5rem, 4.5vw, 2rem); }

            .doctors-inline {
                flex-direction: row;
                gap: 2rem;
            }

            .doctor-mini {
                flex-direction: row;
                text-align: left;
            }

            .locations-mini {
                grid-template-columns: repeat(3, 1fr);
            }

            .scroll-indicator { display: none; }
        }

        /* ========================================
           TABLET — iPads, surface 769-1199px
           ======================================== */
        @media (min-width: 769px) and (max-width: 1199px) {
            nav {
                padding: 1.2rem 2rem;
                padding-top: max(1.2rem, env(safe-area-inset-top));
            }

            .scroll-section {
                padding: 0 5%;
            }

            .content-panel {
                max-width: 420px;
            }

            .content-panel h1 {
                font-size: clamp(2.5rem, 5vw, 3.5rem);
            }

            .content-panel h2 {
                font-size: clamp(2rem, 4.5vw, 3rem);
            }

            .content-panel p {
                max-width: 380px;
            }

            .cta-button {
                min-height: 48px;
            }

            .nav-cta {
                min-height: 44px;
                display: inline-flex;
                align-items: center;
            }

            .locations-mini {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.75rem;
            }

            .location-mini {
                padding: 0.85rem;
                border-radius: 6px;
            }

            .location-mini h5 { font-size: 1rem; }
            .location-mini span { font-size: 0.75rem; }

            #model-glow {
                width: 380px;
                height: 380px;
            }

            footer {
                padding-bottom: max(2rem, env(safe-area-inset-bottom));
            }
        }

        /* ========================================
           REDUCED MOTION — accessibility
           ======================================== */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            .scroll-indicator { display: none; }
        }
    </style>
</head>
<body>
    <div id="loading">
        <div class="loader-wrap">
            <div class="loader-logo"><span>teamdental</span></div>
            <div class="loader"></div>
            <p class="loader-text">Loading 3D Model</p>
        </div>
    </div>

    <nav class="intro-hidden intro-from-top" id="mainNav">
        <a href="#" class="nav-logo">
            <div class="nav-logo-box"><span>teamdental</span></div>
        </a>
        <ul class="nav-links">
            <li><a href="#benefits">Benefits</a></li>
            <li><a href="#doctors">Doctors</a></li>
            <li><a href="#consultation">Book Now</a></li>
        </ul>
        <button class="nav-cta" onclick="document.getElementById('consultation').scrollIntoView({behavior: 'smooth'})">Book Now</button>
    </nav>

    <!-- Fixed 3D Canvas -->
    <div id="canvas-container">
        <div id="model-glow"></div>
    </div>

    <!-- Scroll indicator -->
    <div class="scroll-indicator" id="scrollIndicator">
        <span>Scroll to explore</span>
        <div class="scroll-arrow"></div>
    </div>

    <!-- Scroll-driven content sections -->
    <div class="scroll-container">

        <!-- Section 1: Hero - Left side -->
        <section class="scroll-section section-hero">
            <div class="content-panel from-left intro-hidden" id="heroPanel" data-animate>
                <p class="hero-eyebrow">Introducing</p>
                <h1>Facegenics<br>Midface <em>Expander</em></h1>
                <p>Revolutionary non-surgical palate expansion for adults. Experience the future of facial aesthetics.</p>
                <a href="https://teamdental.com/fme" class="cta-button">
                    Book Your Consult
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>
        </section>

        <!-- Section 2: Technology - Right side (pinned, scroll-driven reveals) -->
        <section class="scroll-section section-pinned" style="height: 250vh;">
            <div class="pin-wrap">
                <div class="content-panel from-right">
                    <div class="badge" data-reveal>Now Available</div>
                    <h2 data-reveal>FME 6-8-10<br><em>TAD System</em></h2>
                    <p data-reveal>Featuring Temporary Anchorage Devices for enhanced precision and predictable results. Our proprietary design delivers controlled expansion with maximum comfort.</p>
                    <p data-reveal style="color: var(--gold); font-size: 0.85rem;">Protraction system coming soon.</p>
                </div>
            </div>
        </section>

        <!-- Section 3: Benefits - Left side (pinned, each bullet reveals on scroll) -->
        <section class="scroll-section section-pinned" id="benefits" style="height: 350vh;">
            <div class="pin-wrap">
                <div class="content-panel from-left">
                    <h2 data-reveal>Transform<br>Your <em>Life</em></h2>
                    <ul class="benefits-list">
                        <li data-reveal>Wider, Fuller Smile</li>
                        <li data-reveal>Improved Nasal Breathing</li>
                        <li data-reveal>Relief from TMJ & Snoring</li>
                        <li data-reveal>Non-Surgical Treatment</li>
                        <li data-reveal>Custom-Engineered Design</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Section 4: Doctors - Centered -->
        <section class="scroll-section section-doctors" id="doctors">
            <div class="content-panel from-left" data-animate>
                <p class="hero-eyebrow" style="color: #C9A962;">Your Expert Team</p>
                <h3 style="color: #C9A962;">Meet Your Doctors</h3>
                <p>Our dynamic doctor duo brings an unrivaled combination of specialized knowledge and experience.</p>
                <div class="doctors-inline">
                    <div class="doctor-mini">
                        <div class="doctor-mini-avatar">MJ</div>
                        <div class="doctor-mini-info">
                            <h4>Dr. Murtuza Jaffari</h4>
                            <span>FME Specialist</span>
                        </div>
                    </div>
                    <div class="doctor-mini">
                        <div class="doctor-mini-avatar">ZN</div>
                        <div class="doctor-mini-info">
                            <h4>Dr. Zubad Newaz</h4>
                            <span>FME Specialist</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: CTA - Center -->
        <section class="scroll-section section-cta" id="consultation">
            <div class="content-panel from-left" data-animate>
                <p class="hero-eyebrow">Ready to Transform?</p>
                <h2>Schedule Your<br><em>Consultation</em></h2>
                <p>There is no one-size-fits-all treatment. Receive a thorough, custom evaluation to know the full range of treatment options for your situation.</p>
                <a href="https://teamdental.com/fme" class="cta-button" style="margin-bottom: 2rem;">
                    Book Consultation
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
                <div class="locations-mini">
                    <div class="location-mini">
                        <h5>New York City</h5>
                        <a href="tel:2124821212">212-482-1212</a>
                    </div>
                    <div class="location-mini">
                        <h5>Philadelphia</h5>
                        <a href="tel:2155985100">215-598-5100</a>
                    </div>
                    <div class="location-mini">
                        <h5>Swedesboro</h5>
                        <a href="tel:8564674677">856-467-4677</a>
                    </div>
                    <div class="location-mini">
                        <h5>Ponte Vedra</h5>
                        <a href="tel:9042739115">904-273-9115</a>
                    </div>
                    <div class="location-mini">
                        <h5>Vermont</h5>
                        <a href="tel:8028767803">802-876-7803</a>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-logo"><span>teamdental</span></div>
            <ul class="footer-links">
                <li><a href="#">Home</a></li>
                <li><a href="#">Services</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Careers</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
            <a href="object_0.glb" download="FME-3D-Model.glb" class="download-model-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7 10 12 15 17 10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download 3D Model
            </a>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 Team Dental. All rights reserved.</p>
            <p style="font-size: 0.7rem; color: rgba(138, 141, 144, 0.6);">*With accepted insurance, some restrictions apply. Individual results may vary.</p>
        </div>
    </footer>

    <!-- Three.js r170 -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

        const container = document.getElementById('canvas-container');
        const sections = document.querySelectorAll('.scroll-section');
        const panels = document.querySelectorAll('[data-animate]');
        const scrollIndicator = document.getElementById('scrollIndicator');

        // Detect device type — used for renderer quality and keyframe selection
        const isMobile = window.innerWidth <= 768;
        const isTablet = window.innerWidth > 768 && window.innerWidth <= 1199;

        // Scene setup
        const scene = new THREE.Scene();

        // Camera
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0.3, 3.5);

        // Renderer — lean settings, no shadows (none configured), capped pixel ratio
        const maxDPR = isMobile ? 1.5 : Math.min(window.devicePixelRatio, 2);
        const renderer = new THREE.WebGLRenderer({
            antialias: !isMobile, // skip AA on mobile for perf
            alpha: true,
            powerPreference: 'high-performance',
            stencil: false,
            depth: true
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(maxDPR);
        renderer.outputColorSpace = THREE.SRGBColorSpace;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.4;
        container.appendChild(renderer.domElement);

        // Handle WebGL context loss gracefully (prevents crash→reload loop)
        renderer.domElement.addEventListener('webglcontextlost', (e) => {
            e.preventDefault();
            console.warn('WebGL context lost');
        });
        renderer.domElement.addEventListener('webglcontextrestored', () => {
            console.log('WebGL context restored');
        });

        // Environment lighting
        const pmremGenerator = new THREE.PMREMGenerator(renderer);
        pmremGenerator.compileEquirectangularShader();

        // Create custom environment
        const envScene = new THREE.Scene();
        const envGeo = new THREE.SphereGeometry(50, 32, 32);
        const envMat = new THREE.ShaderMaterial({
            side: THREE.BackSide,
            uniforms: {
                uTime: { value: 0 }
            },
            vertexShader: `
                varying vec3 vWorldPosition;
                void main() {
                    vec4 worldPosition = modelMatrix * vec4(position, 1.0);
                    vWorldPosition = worldPosition.xyz;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                }
            `,
            fragmentShader: `
                varying vec3 vWorldPosition;
                void main() {
                    float h = normalize(vWorldPosition).y;
                    vec3 topColor = vec3(0.1, 0.1, 0.15);
                    vec3 midColor = vec3(0.18, 0.16, 0.14);
                    vec3 bottomColor = vec3(0.05, 0.05, 0.07);
                    vec3 color = mix(bottomColor, midColor, smoothstep(-1.0, 0.0, h));
                    color = mix(color, topColor, smoothstep(0.0, 1.0, h));

                    // Light spots
                    float spot1 = smoothstep(0.9, 1.0, dot(normalize(vWorldPosition), normalize(vec3(1.0, 1.0, 1.0))));
                    float spot2 = smoothstep(0.85, 1.0, dot(normalize(vWorldPosition), normalize(vec3(-1.0, 0.5, 0.5))));
                    float spot3 = smoothstep(0.88, 1.0, dot(normalize(vWorldPosition), normalize(vec3(0.0, -1.0, 0.5))));

                    color += vec3(1.0, 0.95, 0.85) * spot1 * 2.0;
                    color += vec3(0.7, 0.8, 0.9) * spot2 * 1.0;
                    color += vec3(0.9, 0.85, 0.8) * spot3 * 0.8;

                    gl_FragColor = vec4(color, 1.0);
                }
            `
        });
        const envMesh = new THREE.Mesh(envGeo, envMat);
        envScene.add(envMesh);

        const cubeRenderTarget = new THREE.WebGLCubeRenderTarget(256);
        const cubeCamera = new THREE.CubeCamera(0.1, 100, cubeRenderTarget);
        cubeCamera.update(renderer, envScene);
        const envMap = pmremGenerator.fromCubemap(cubeRenderTarget.texture).texture;
        scene.environment = envMap;

        // Lighting setup - tuned for brushed metal and anodized finishes
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        // Key light - warm, strong, from upper right (main highlight on metal)
        const keyLight = new THREE.DirectionalLight(0xfff5e6, 3.5);
        keyLight.position.set(3, 5, 5);
        scene.add(keyLight);

        // Fill light - softer warm tone from left
        const fillLight = new THREE.DirectionalLight(0xf0e8e0, 1.8);
        fillLight.position.set(-5, 2, 3);
        scene.add(fillLight);

        // Rim light - cool blue to bring out the blue anodized titanium
        const rimLight = new THREE.DirectionalLight(0x6BB5E8, 1.5);
        rimLight.position.set(0, 2, -5);
        scene.add(rimLight);

        // Bottom fill - subtle, prevents harsh shadows underneath
        const bottomLight = new THREE.DirectionalLight(0xffffff, 0.8);
        bottomLight.position.set(0, -5, 3);
        scene.add(bottomLight);

        // Top accent - catches the top edges of the device
        const topAccent = new THREE.DirectionalLight(0xffffff, 1.0);
        topAccent.position.set(0, 8, 0);
        scene.add(topAccent);

        // Model
        let model = null;
        const modelGroup = new THREE.Group();
        const pivotGroup = new THREE.Group(); // Handles Y rotation (trophy spin)
        const flipGroup = new THREE.Group(); // Handles upside-down flip
        flipGroup.rotation.z = Math.PI; // Flip 180 degrees upside down
        pivotGroup.add(modelGroup);
        flipGroup.add(pivotGroup);
        scene.add(flipGroup);

        // Target rotations (controlled by scroll)
        // Model is pre-rotated to stand upright, so only Y rotation needed for spinning
        let targetRotationY = Math.PI; // Start rotated to show front face (flipped model)
        let currentRotationY = Math.PI; // Match initial pose

        // Position and zoom targets (adjusted for device)
        // Mobile: model pushed to upper viewport so content panels don't cover it
        const initialZoom = isMobile ? 10.0 : 10.0;
        const initialY = isMobile ? 2.2 : isTablet ? 0.2 : 0;
        let targetPositionX = 0;
        let targetPositionY = initialY;
        let targetZoom = initialZoom;
        let currentPositionX = 0;
        let currentPositionY = initialY;
        let currentZoom = initialZoom;

        // Easing function for smooth acceleration/deceleration
        function easeInOutCubic(t) {
            return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
        }

        // Keyframes for the animation journey
        // Content layout: Hero(left), Benefits(right), Tech(left), Doctors(right), CTA(center)
        // Model moves OPPOSITE to content for visual balance
        // Model is pre-rotated to stand upright, rotY spins it around vertical axis
        // Front face offset. Slow down at content sections by having less rotation change.
        const frontFace = Math.PI; // Rotate 180 to show front face (since model is flipped)

        // Desktop keyframes - model stays at comfortable distance, gentle side-to-side
        // Front face lands on even π multiples (2, 4, 6, 8) to align with content sections
        // Content: Hero(left), Benefits(right), Tech(left), Doctors(right), CTA(center)
        // Model sits OPPOSITE side of text for visual balance
        // Model fades out after Technology section - shrinks and drifts left before Doctors
        // Desktop keyframes — adjusted for pinned section heights (100+250+350+100+100vh)
        const desktopKeyframes = [
            // Hero (0 → 0.11): model right, front face
            { scroll: 0.00, x: 0.5,  y: 0,    zoom: 10.0, rotX: 0, rotY: frontFace,                  rotZ: 0 },
            { scroll: 0.08, x: 0.6,  y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 0.15, rotZ: 0 },
            // Transition to TAD
            { scroll: 0.14, x: 0,    y: 0.08, zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 1.0,  rotZ: 0 },
            // TAD (0.11 → 0.39): model left, slow spin through section
            { scroll: 0.20, x: -0.6, y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 2.0,  rotZ: 0 },
            { scroll: 0.32, x: -0.55,y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 2.5,  rotZ: 0 },
            // Transition to Benefits
            { scroll: 0.40, x: 0,    y: 0.08, zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 3.0,  rotZ: 0 },
            // Benefits (0.39 → 0.78): model right, very slow spin as bullets reveal
            { scroll: 0.48, x: 0.6,  y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 4.0,  rotZ: 0 },
            { scroll: 0.62, x: 0.55, y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 4.5,  rotZ: 0 },
            // Exit: model fades before Doctors
            { scroll: 0.72, x: -0.3, y: 0,    zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 5.0,  rotZ: 0 },
            // Invisible from here
            { scroll: 0.80, x: -0.4, y: 0,    zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 6.0,  rotZ: 0 },
            { scroll: 0.88, x: 0,    y: 0,    zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 6.5,  rotZ: 0 },
            { scroll: 1.00, x: 0,    y: 0,    zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 7.0,  rotZ: 0 },
        ];

        // Mobile keyframes - model pushed to upper viewport, content scrolls below
        // y=2.0-2.2 positions model in top ~30% of screen
        // ROTATION STRATEGY: slow, continuous spin with variable speed
        //   - SLOW when model is visible between text sections (lingers on front face)
        //   - Gentle turn through back when text content is covering the model
        //   - easeInOutCubic naturally pauses at keyframe positions
        // Mobile keyframes — adjusted for pinned section heights
        // Slow, continuous spin — front face lingers between sections
        const mobileKeyframes = [
            // Hero (0 → 0.11): front face, gentle angle
            { scroll: 0.00, x: 0, y: 2.2,  zoom: 10.0, rotX: 0, rotY: frontFace,                   rotZ: 0 },
            { scroll: 0.06, x: 0, y: 2.15, zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 0.15,  rotZ: 0 },
            { scroll: 0.11, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 0.5,   rotZ: 0 },

            // TAD (0.11 → 0.39): slow spin through pinned section
            { scroll: 0.16, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 1.0,   rotZ: 0 },
            { scroll: 0.22, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 1.5,   rotZ: 0 },
            { scroll: 0.28, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 2.0,   rotZ: 0 },
            { scroll: 0.35, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 2.5,   rotZ: 0 },

            // Benefits (0.39 → 0.78): slow spin as bullets appear
            { scroll: 0.42, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 3.0,   rotZ: 0 },
            { scroll: 0.50, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 3.5,   rotZ: 0 },
            { scroll: 0.58, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 4.0,   rotZ: 0 },
            { scroll: 0.66, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 4.5,   rotZ: 0 },

            // Exit — fade out before Doctors
            { scroll: 0.72, x: 0, y: 2.0,  zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 5.0,   rotZ: 0 },
            { scroll: 0.78, x: 0, y: 2.0,  zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 5.5,   rotZ: 0 },
            // Faded out
            { scroll: 0.85, x: 0, y: 2.0,  zoom: 14.0, rotX: 0, rotY: frontFace + Math.PI * 6.0,   rotZ: 0 },
            { scroll: 1.00, x: 0, y: 2.0,  zoom: 14.0, rotX: 0, rotY: frontFace + Math.PI * 7.0,   rotZ: 0 },
        ];

        // Tablet keyframes — adjusted for pinned section heights
        const tabletKeyframes = [
            { scroll: 0.00, x: 0.3,   y: 0.2,  zoom: 10.0, rotX: 0, rotY: frontFace,                  rotZ: 0 },
            { scroll: 0.08, x: 0.4,   y: 0.2,  zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 0.15, rotZ: 0 },
            { scroll: 0.14, x: 0,     y: 0.25, zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 1.0,  rotZ: 0 },
            { scroll: 0.22, x: -0.4,  y: 0.2,  zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 2.0,  rotZ: 0 },
            { scroll: 0.32, x: -0.35, y: 0.2,  zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 2.5,  rotZ: 0 },
            { scroll: 0.40, x: 0,     y: 0.25, zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 3.0,  rotZ: 0 },
            { scroll: 0.48, x: 0.4,   y: 0.2,  zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 4.0,  rotZ: 0 },
            { scroll: 0.62, x: 0.35,  y: 0.2,  zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 4.5,  rotZ: 0 },
            { scroll: 0.72, x: -0.2,  y: 0.2,  zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 5.0,  rotZ: 0 },
            { scroll: 0.80, x: -0.3,  y: 0.2,  zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 6.0,  rotZ: 0 },
            { scroll: 0.88, x: 0,     y: 0.2,  zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 6.5,  rotZ: 0 },
            { scroll: 1.00, x: 0,     y: 0.2,  zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 7.0,  rotZ: 0 },
        ];

        // Select keyframes based on device
        const keyframes = isMobile ? mobileKeyframes : isTablet ? tabletKeyframes : desktopKeyframes;

        // Interpolate between keyframes
        function getInterpolatedValues(progress) {
            // Find the two keyframes we're between
            let startFrame = keyframes[0];
            let endFrame = keyframes[keyframes.length - 1];

            for (let i = 0; i < keyframes.length - 1; i++) {
                if (progress >= keyframes[i].scroll && progress <= keyframes[i + 1].scroll) {
                    startFrame = keyframes[i];
                    endFrame = keyframes[i + 1];
                    break;
                }
            }

            // Calculate local progress between these two keyframes
            const range = endFrame.scroll - startFrame.scroll;
            const localProgress = range > 0 ? (progress - startFrame.scroll) / range : 0;
            const easedProgress = easeInOutCubic(localProgress);

            // Interpolate all values
            return {
                x: startFrame.x + (endFrame.x - startFrame.x) * easedProgress,
                y: startFrame.y + (endFrame.y - startFrame.y) * easedProgress,
                zoom: startFrame.zoom + (endFrame.zoom - startFrame.zoom) * easedProgress,
                rotX: startFrame.rotX + (endFrame.rotX - startFrame.rotX) * easedProgress,
                rotY: startFrame.rotY + (endFrame.rotY - startFrame.rotY) * easedProgress,
                rotZ: startFrame.rotZ + (endFrame.rotZ - startFrame.rotZ) * easedProgress,
            };
        }

        function centerAndScaleModel(object) {
            const box = new THREE.Box3().setFromObject(object);
            const center = box.getCenter(new THREE.Vector3());
            const size = box.getSize(new THREE.Vector3());
            const maxDim = Math.max(size.x, size.y, size.z);
            const scale = 2.2 / maxDim;
            object.position.sub(center);
            object.scale.multiplyScalar(scale);
            return object;
        }

        const loader = new GLTFLoader();
        loader.load(
            'object_0.glb',
            (gltf) => {
                model = gltf.scene;

                // Enhanced material assignment based on reference photos:
                // 1. Main body: dark gunmetal gray, matte satin finish
                // 2. Frame/edges: champagne silver, brushed satin
                // 3. Blue screws/posts: deep cobalt blue anodized titanium
                // 4. Front screws: bright zinc silver, polished

                model.traverse((child) => {
                    if (child.isMesh && child.material) {
                        const mat = child.material;
                        const c = mat.color;

                        mat.envMap = envMap;

                        // Classify material by color to apply correct finish
                        const r = c.r, g = c.g, b = c.b;
                        const brightness = (r + g + b) / 3;
                        const isBlue = b > r * 1.3 && b > g * 1.1;
                        const isLight = brightness > 0.5;
                        const isDark = brightness < 0.25;

                        if (isBlue) {
                            // Blue anodized titanium screws/posts/caps
                            mat.color.setHex(0x1A3A5C); // Deep cobalt blue
                            mat.metalness = 0.85;
                            mat.roughness = 0.18;
                            mat.envMapIntensity = 1.8;
                        } else if (isLight) {
                            // Champagne silver frame/edges - brushed satin
                            mat.color.setHex(0xC0B8A8); // Warm champagne silver
                            mat.metalness = 0.92;
                            mat.roughness = 0.28;
                            mat.envMapIntensity = 1.4;
                        } else if (isDark) {
                            // Dark gunmetal gray main body - matte satin
                            mat.color.setHex(0x4A4D52); // Gunmetal gray
                            mat.metalness = 0.7;
                            mat.roughness = 0.42;
                            mat.envMapIntensity = 1.0;
                        } else {
                            // Mid-tone parts (zinc screws, etc.) - polished silver
                            mat.color.setHex(0x8A8D90); // Zinc silver
                            mat.metalness = 0.88;
                            mat.roughness = 0.2;
                            mat.envMapIntensity = 1.5;
                        }

                        mat.needsUpdate = true;
                    }
                });
                centerAndScaleModel(model);
                modelGroup.add(model);
                // Rotate modelGroup to stand upright
                // pivotGroup will then spin this on world Y axis
                // flipGroup handles the 180 degree upside-down flip
                modelGroup.rotation.x = -Math.PI * 0.5; // Stand upright
                document.getElementById('loading').classList.add('hidden');

                // Cinematic intro — slow, layered reveal
                const navEl = document.getElementById('mainNav');
                const heroEl = document.getElementById('heroPanel');

                // 1. Model begins slow fade-in + scale-up (300ms pause after loader)
                setTimeout(() => { container.classList.add('loaded'); }, 300);

                // 2. Nav glides down from top (1s — model is ~25% faded in)
                setTimeout(() => {
                    navEl.classList.remove('intro-hidden', 'intro-from-top');
                    navEl.classList.add('intro-visible');
                }, 1000);

                // 3. Hero content rises into place (1.6s — model is ~45% faded in)
                setTimeout(() => {
                    heroEl.classList.remove('intro-hidden');
                    heroEl.classList.add('intro-visible', 'visible');
                }, 1600);

                // 4. Scroll indicator (3.5s — everything else is settled)
                setTimeout(() => { scrollIndicator.classList.add('intro-ready'); }, 3500);

                // Initial scroll position + panel visibility + reveals
                updateScrollAnimation();
                updatePanelsAndParallax();
                updateScrollReveals();
            },
            (progress) => {
                if (progress.total > 0) {
                    const percent = (progress.loaded / progress.total * 100).toFixed(0);
                    document.querySelector('.loader-text').textContent = `Loading 3D Model ${percent}%`;
                }
            },
            (error) => {
                console.error('Error loading model:', error);
                document.getElementById('loading').classList.add('hidden');
            }
        );

        // Scroll-driven animation - position, zoom, and rotation
        function updateScrollAnimation() {
            const scrollY = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollProgress = Math.min(Math.max(scrollY / docHeight, 0), 1);

            // Get interpolated values from keyframes
            const values = getInterpolatedValues(scrollProgress);

            // Set targets
            targetPositionX = values.x;
            targetPositionY = values.y;
            targetZoom = values.zoom;
            targetRotationY = values.rotY;

            // Hide scroll indicator after scrolling
            if (scrollY > 100) {
                scrollIndicator.classList.add('hidden');
            } else {
                scrollIndicator.classList.remove('hidden');
            }
        }

        // Scroll-driven panel visibility + parallax (non-pinned sections only)
        const doctorsSection = document.getElementById('doctors');
        let modelHidden = false;

        function updatePanelsAndParallax() {
            const viewH = window.innerHeight;

            // Panel visibility — only for non-pinned [data-animate] panels
            panels.forEach(panel => {
                const rect = panel.getBoundingClientRect();
                const inView = rect.top < viewH * 0.92 && rect.bottom > viewH * 0.08;
                const hasVisible = panel.classList.contains('visible');

                if (inView && !hasVisible) {
                    panel.classList.add('visible');
                } else if (!inView && hasVisible && (rect.top > viewH || rect.bottom < 0)) {
                    panel.classList.remove('visible');
                }
            });

            // Parallax — skip pinned sections (transform breaks position:sticky)
            sections.forEach(section => {
                if (section.classList.contains('section-pinned')) return;
                const rect = section.getBoundingClientRect();
                const offset = (rect.top + rect.height * 0.5 - viewH * 0.5) / viewH;
                section.style.transform = `translateY(${offset * -20}px) translateZ(0)`;
            });

            // Canvas fade — model exits before doctors section
            if (container.classList.contains('loaded') && doctorsSection) {
                const dTop = doctorsSection.getBoundingClientRect().top;
                const shouldExit = dTop < viewH * 0.4;
                const hasExit = container.classList.contains('exit');
                if (shouldExit && !hasExit) {
                    container.classList.add('exit');
                    setTimeout(() => { modelHidden = true; }, 900);
                } else if (!shouldExit && hasExit) {
                    container.classList.remove('exit');
                    modelHidden = false;
                }
            }
        }

        // Scroll-driven reveals for pinned sections
        // Each [data-reveal] item fades in from below based on scroll progress through its section
        const pinnedSections = document.querySelectorAll('.section-pinned');
        function updateScrollReveals() {
            const viewH = window.innerHeight;

            pinnedSections.forEach(section => {
                const rect = section.getBoundingClientRect();
                const scrolledInto = -rect.top;
                const scrollRange = section.offsetHeight - viewH;
                if (scrollRange <= 0) return; // safety: section shorter than viewport
                const progress = Math.max(0, Math.min(1, scrolledInto / scrollRange));

                const items = section.querySelectorAll('[data-reveal]');
                const count = items.length;

                items.forEach((item, i) => {
                    // Each item gets an equal slice of the scroll range
                    // First item starts at 5% scroll, last finishes at 85%
                    const start = 0.05 + (i / count) * 0.75;
                    const end = start + 0.12;
                    const p = Math.max(0, Math.min(1, (progress - start) / (end - start)));

                    // easeOutCubic for smooth deceleration
                    const eased = 1 - Math.pow(1 - p, 3);

                    item.style.opacity = eased;
                    item.style.transform = `translateY(${(1 - eased) * 30}px)`;
                });
            });
        }

        // rAF-throttled scroll handler
        let scrollTicking = false;
        window.addEventListener('scroll', () => {
            if (!scrollTicking) {
                requestAnimationFrame(() => {
                    updateScrollAnimation();
                    updatePanelsAndParallax();
                    updateScrollReveals();
                    scrollTicking = false;
                });
                scrollTicking = true;
            }
        }, { passive: true });

        // Animation loop — delta-time lerp, skips GPU render when model invisible
        let lastTimestamp = 0;
        function animate(timestamp) {
            requestAnimationFrame(animate);

            // Delta-time exponential lerp — consistent across 60/120Hz
            const dt = Math.min((timestamp - lastTimestamp) / 1000, 0.05);
            lastTimestamp = timestamp;
            const lerpFactor = 1 - Math.exp(-8 * dt);

            currentRotationY += (targetRotationY - currentRotationY) * lerpFactor;
            currentPositionX += (targetPositionX - currentPositionX) * lerpFactor;
            currentPositionY += (targetPositionY - currentPositionY) * lerpFactor;
            currentZoom += (targetZoom - currentZoom) * lerpFactor;

            pivotGroup.rotation.y = currentRotationY;
            flipGroup.position.x = currentPositionX;
            camera.position.z = currentZoom;

            // Subtle floating
            const time = (timestamp || 0) * 0.001;
            flipGroup.position.y = currentPositionY + Math.sin(time * 0.8) * 0.012;

            // Skip GPU render when model is fully faded out — massive perf savings
            if (!modelHidden) {
                renderer.render(scene, camera);
            }
        }

        requestAnimationFrame(animate);

        // Handle resize — debounced for Safari performance
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(maxDPR);
            }, 100);
        });
    </script>
</body>
</html>
