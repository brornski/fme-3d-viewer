<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facegenics Midface Expander (FME) | Team Dental</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ivory: #FAF9F6;
            --obsidian: #0D0D0D;
            --titanium: #8A8D90;
            --gold: #A0CBE8;
            --gold-light: #C4DFF2;
            --slate: #2A2D32;
            --cream: #F5F3EE;
            --team-blue: #4A9FD4;
            --team-blue-dark: #3B82C4;
            --team-blue-light: #87CEEB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--obsidian);
            color: var(--ivory);
            overflow-x: hidden;
            font-weight: 500;
        }

        /* Noise texture overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            z-index: 10000;
        }

        /* Loading screen */
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--obsidian);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loader-wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        .loader-logo {
            padding: 15px 30px;
            background: linear-gradient(180deg, var(--team-blue-dark) 0%, var(--team-blue-light) 100%);
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(59, 130, 196, 0.25);
        }

        .loader-logo span {
            font-family: 'Arial', sans-serif;
            font-size: 1.1rem;
            font-weight: 300;
            letter-spacing: 0.05em;
            color: white;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 1px solid rgba(160, 203, 232, 0.2);
            border-top-color: var(--gold);
            border-radius: 50%;
            animation: spin 1.2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loader-text {
            font-size: 0.75rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--titanium);
        }

        /* Cinematic intro animations */
        .intro-hidden {
            opacity: 0 !important;
            transform: translateY(40px) !important;
            transition: opacity 1.2s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1.2s cubic-bezier(0.16, 1, 0.3, 1) !important;
        }

        .intro-hidden.intro-from-top {
            transform: translateY(-30px) !important;
        }

        .intro-hidden.intro-scale {
            transform: scale(0.95) translateY(20px) !important;
            transition: opacity 1.6s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1.6s cubic-bezier(0.16, 1, 0.3, 1) !important;
        }

        .intro-visible {
            opacity: 1 !important;
            transform: translateY(0) scale(1) !important;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1.5rem 3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: linear-gradient(to bottom, rgba(13, 13, 13, 0.95) 0%, transparent 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
        }

        .nav-logo-box {
            padding: 8px 16px;
            background: linear-gradient(180deg, var(--team-blue-dark) 0%, var(--team-blue-light) 100%);
            border-radius: 6px;
        }

        .nav-logo-box span {
            font-family: 'Arial', sans-serif;
            font-size: 0.9rem;
            font-weight: 300;
            letter-spacing: 0.05em;
            color: white;
        }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            list-style: none;
        }

        .nav-links a {
            font-size: 0.8rem;
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--titanium);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--ivory);
        }

        .nav-cta {
            padding: 0.6rem 1.3rem;
            background: linear-gradient(
                135deg,
                rgba(20, 50, 90, 0.5) 0%,
                rgba(40, 80, 140, 0.35) 50%,
                rgba(30, 60, 110, 0.45) 100%
            );
            border: 1px solid rgba(100, 160, 220, 0.25);
            border-top-color: rgba(140, 190, 240, 0.3);
            color: var(--ivory);
            font-family: 'Inter', sans-serif;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 10px;
            box-shadow:
                0 1px 1px rgba(255, 255, 255, 0.06) inset,
                0 2px 8px rgba(0, 20, 60, 0.25);
        }

        .nav-cta:hover {
            background: linear-gradient(
                135deg,
                rgba(30, 65, 115, 0.65) 0%,
                rgba(50, 95, 160, 0.45) 50%,
                rgba(40, 75, 130, 0.55) 100%
            );
            border-color: rgba(120, 180, 240, 0.4);
            transform: translateY(-1px);
            box-shadow:
                0 1px 1px rgba(255, 255, 255, 0.08) inset,
                0 4px 16px rgba(0, 30, 80, 0.35);
        }

        /* Scroll indicator */
        .scroll-indicator {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            z-index: 100;
            opacity: 0;
            transition: opacity 1s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .scroll-indicator.intro-ready {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .scroll-indicator.hidden {
            opacity: 0 !important;
            pointer-events: none;
            transform: translateX(-50%) translateY(20px) !important;
        }

        .scroll-indicator span {
            font-size: 0.65rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--titanium);
        }

        .scroll-arrow {
            width: 24px;
            height: 24px;
            border-right: 1px solid var(--gold);
            border-bottom: 1px solid var(--gold);
            transform: rotate(45deg);
            animation: scrollBounce 2s ease infinite;
        }

        @keyframes scrollBounce {
            0%, 100% { transform: rotate(45deg) translateY(0); opacity: 1; }
            50% { transform: rotate(45deg) translateY(8px); opacity: 0.5; }
        }

        /* Fixed 3D Canvas - stays in center of viewport */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
            pointer-events: none;
            opacity: 0;
            transform: scale(0.92);
            transition: opacity 1.8s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        #canvas-container.loaded {
            opacity: 1;
            transform: scale(1);
            transition: opacity 1.8s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 1.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        #canvas-container.loaded.exit {
            opacity: 0;
            transform: scale(0.92) translateY(40px);
            transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1),
                        transform 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Scroll container - creates scroll height */
        .scroll-container {
            position: relative;
            z-index: 10;
        }

        /* Scroll sections - each triggers different content */
        .scroll-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            padding: 0 8%;
            position: relative;
        }

        /* Content panels that slide in */
        .content-panel {
            max-width: 450px;
            opacity: 0;
            transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .content-panel.from-left {
            transform: translateX(-100px);
        }

        .content-panel.from-right {
            transform: translateX(100px);
            margin-left: auto;
            text-align: right;
        }

        .content-panel.visible {
            opacity: 1;
            transform: translateX(0);
        }

        /* Staggered animations for child elements */
        .content-panel > * {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .content-panel.visible > *:nth-child(1) { opacity: 1; transform: translateY(0); transition-delay: 0.1s; }
        .content-panel.visible > *:nth-child(2) { opacity: 1; transform: translateY(0); transition-delay: 0.25s; }
        .content-panel.visible > *:nth-child(3) { opacity: 1; transform: translateY(0); transition-delay: 0.4s; }
        .content-panel.visible > *:nth-child(4) { opacity: 1; transform: translateY(0); transition-delay: 0.55s; }
        .content-panel.visible > *:nth-child(5) { opacity: 1; transform: translateY(0); transition-delay: 0.7s; }
        .content-panel.visible > *:nth-child(6) { opacity: 1; transform: translateY(0); transition-delay: 0.85s; }

        /* Benefits list items stagger */
        .benefits-list li {
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .from-right .benefits-list li {
            transform: translateX(20px);
        }

        .content-panel.visible .benefits-list li:nth-child(1) { opacity: 1; transform: translateX(0); transition-delay: 0.5s; }
        .content-panel.visible .benefits-list li:nth-child(2) { opacity: 1; transform: translateX(0); transition-delay: 0.65s; }
        .content-panel.visible .benefits-list li:nth-child(3) { opacity: 1; transform: translateX(0); transition-delay: 0.8s; }
        .content-panel.visible .benefits-list li:nth-child(4) { opacity: 1; transform: translateX(0); transition-delay: 0.95s; }
        .content-panel.visible .benefits-list li:nth-child(5) { opacity: 1; transform: translateX(0); transition-delay: 1.1s; }

        /* Doctors stagger */
        .doctors-inline .doctor-mini {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .content-panel.visible .doctors-inline .doctor-mini:nth-child(1) { opacity: 1; transform: translateY(0); transition-delay: 0.6s; }
        .content-panel.visible .doctors-inline .doctor-mini:nth-child(2) { opacity: 1; transform: translateY(0); transition-delay: 0.85s; }

        /* Locations stagger */
        .locations-mini .location-mini {
            opacity: 0;
            transform: translateY(15px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .content-panel.visible .locations-mini .location-mini:nth-child(1) { opacity: 1; transform: translateY(0); transition-delay: 0.7s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(2) { opacity: 1; transform: translateY(0); transition-delay: 0.8s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(3) { opacity: 1; transform: translateY(0); transition-delay: 0.9s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(4) { opacity: 1; transform: translateY(0); transition-delay: 1.0s; }
        .content-panel.visible .locations-mini .location-mini:nth-child(5) { opacity: 1; transform: translateY(0); transition-delay: 1.1s; }

        /* Section 1 - Hero */
        .section-hero {
            min-height: 100vh;
        }

        .hero-eyebrow {
            font-size: 0.75rem;
            letter-spacing: 0.4em;
            text-transform: uppercase;
            color: var(--gold);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-weight: 600;
        }

        .hero-eyebrow::before {
            content: '';
            width: 40px;
            height: 1px;
            background: var(--gold);
        }

        .from-right .hero-eyebrow {
            justify-content: flex-end;
        }

        .from-right .hero-eyebrow::before {
            order: 2;
        }

        .content-panel h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: clamp(3rem, 6vw, 4.5rem);
            font-weight: 600;
            line-height: 1.05;
            letter-spacing: -0.03em;
            margin-bottom: 1.25rem;
        }

        .content-panel h1 em {
            font-style: italic;
            color: var(--gold);
        }

        .content-panel p {
            font-size: 1rem;
            line-height: 1.7;
            color: var(--ivory);
            margin-bottom: 1.5rem;
            font-weight: 500;
            letter-spacing: 0.01em;
            opacity: 0.75;
        }

        .content-panel h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: clamp(2.4rem, 5vw, 3.5rem);
            font-weight: 600;
            line-height: 1.1;
            margin-bottom: 1rem;
        }

        .content-panel h2 em {
            font-style: italic;
            color: var(--gold);
        }

        .content-panel h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--ivory);
        }

        /* Benefits list */
        .benefits-list {
            list-style: none;
        }

        .benefits-list li {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.8rem;
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--ivory);
            opacity: 0.85;
            letter-spacing: 0.02em;
            transition: color 0.3s ease;
        }

        .from-right .benefits-list li {
            justify-content: flex-end;
        }

        .benefits-list li::before {
            content: '';
            width: 20px;
            height: 1px;
            background: var(--gold);
            flex-shrink: 0;
        }

        .from-right .benefits-list li::before {
            order: 2;
        }

        /* Badge */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: linear-gradient(135deg, var(--team-blue-dark) 0%, var(--team-blue) 100%);
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: white;
            margin-bottom: 1rem;
        }

        .badge::before {
            content: '';
            width: 5px;
            height: 5px;
            background: var(--gold);
            border-radius: 50%;
            animation: pulse 2s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* CTA Button */
        .cta-button {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 2rem;
            background: linear-gradient(
                135deg,
                rgba(20, 50, 90, 0.6) 0%,
                rgba(40, 80, 140, 0.4) 40%,
                rgba(60, 110, 170, 0.3) 60%,
                rgba(30, 60, 110, 0.5) 100%
            );
            color: var(--ivory);
            text-decoration: none;
            font-size: 0.85rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            font-weight: 700;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(100, 160, 220, 0.25);
            border-top-color: rgba(140, 190, 240, 0.35);
            border-left-color: rgba(120, 170, 230, 0.3);
            cursor: pointer;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 14px;
            box-shadow:
                0 1px 1px rgba(255, 255, 255, 0.08) inset,
                0 -1px 1px rgba(0, 0, 0, 0.15) inset,
                0 4px 16px rgba(0, 20, 60, 0.3),
                0 1px 3px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(
                to bottom,
                rgba(140, 190, 240, 0.15) 0%,
                rgba(140, 190, 240, 0.02) 100%
            );
            border-radius: 14px 14px 0 0;
            pointer-events: none;
        }

        .cta-button:hover {
            background: linear-gradient(
                135deg,
                rgba(30, 65, 115, 0.7) 0%,
                rgba(50, 95, 160, 0.5) 40%,
                rgba(70, 125, 190, 0.4) 60%,
                rgba(40, 75, 130, 0.6) 100%
            );
            transform: translateY(-2px);
            border-color: rgba(120, 180, 240, 0.4);
            box-shadow:
                0 1px 1px rgba(255, 255, 255, 0.1) inset,
                0 -1px 1px rgba(0, 0, 0, 0.15) inset,
                0 8px 32px rgba(0, 30, 80, 0.4),
                0 2px 6px rgba(0, 0, 0, 0.25);
        }

        .cta-button svg {
            width: 16px;
            height: 16px;
        }

        /* Doctor cards inline */
        .doctors-inline {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .from-right .doctors-inline {
            justify-content: flex-end;
        }

        .doctor-mini {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .from-right .doctor-mini {
            flex-direction: row-reverse;
        }

        .doctor-mini-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1rem;
            color: var(--obsidian);
        }

        .doctor-mini-info h4 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .doctor-mini-info span {
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--gold);
        }

        /* Doctors section - centered */
        .section-doctors {
            justify-content: center;
            text-align: center;
        }

        .section-doctors .content-panel {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .section-doctors .content-panel.from-left {
            transform: translateY(50px);
        }

        .section-doctors .content-panel.visible {
            transform: translateY(0);
        }

        .section-doctors .hero-eyebrow {
            justify-content: center;
        }

        .section-doctors .doctors-inline {
            justify-content: center;
        }

        .section-doctors .doctor-mini-info span {
            color: #C9A962;
        }

        .section-doctors .doctor-mini-avatar {
            background: linear-gradient(135deg, #C9A962 0%, #E8D5A3 100%);
        }

        .section-doctors .hero-eyebrow::before {
            background: #C9A962;
        }

        /* Final CTA section - smooth gradient from black to gray */
        .section-cta {
            background: linear-gradient(to bottom,
                var(--obsidian) 0%,
                var(--slate) 50%,
                var(--slate) 100%);
            justify-content: center;
            text-align: center;
        }

        .section-cta .content-panel {
            max-width: 600px;
            text-align: center;
        }

        .section-cta .content-panel.from-left {
            transform: translateY(50px);
        }

        .section-cta .content-panel.visible {
            transform: translateY(0);
        }

        /* Locations grid */
        .locations-mini {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
            text-align: left;
        }

        .location-mini {
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.8rem;
        }

        .location-mini h5 {
            color: var(--team-blue);
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .location-mini span {
            color: var(--titanium);
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Download button */
        .download-model-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.2rem;
            border: 1px solid var(--gold);
            color: var(--gold);
            text-decoration: none;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            transition: all 0.3s ease;
        }

        .download-model-btn:hover {
            background: var(--gold);
            color: var(--obsidian);
        }

        /* Footer */
        footer {
            background: var(--slate);
            padding: 4rem 8% 2rem;
            position: relative;
            z-index: 20;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 3rem;
            margin-bottom: 3rem;
            padding-bottom: 3rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-logo {
            padding: 10px 20px;
            background: linear-gradient(180deg, var(--team-blue-dark) 0%, var(--team-blue-light) 100%);
            border-radius: 6px;
        }

        .footer-logo span {
            font-family: 'Arial', sans-serif;
            font-size: 1rem;
            font-weight: 300;
            letter-spacing: 0.05em;
            color: white;
        }

        .footer-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .footer-links a {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--titanium);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--team-blue);
        }

        .footer-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-bottom p {
            font-size: 0.75rem;
            color: var(--titanium);
        }

        /* Responsive - Apple-inspired clean mobile design */
        @media (max-width: 768px) {
            nav {
                padding: 1rem 1.5rem;
                background: rgba(13, 13, 13, 0.9);
                backdrop-filter: blur(20px);
                -webkit-backdrop-filter: blur(20px);
            }

            .nav-links {
                display: none;
            }

            /* Each section is full height with clear separation */
            .scroll-section {
                min-height: 100vh;
                padding: 0;
                display: flex;
                flex-direction: column;
                justify-content: flex-end;
                align-items: stretch;
            }

            /* Hero section - model at top, content at bottom */
            .section-hero {
                justify-content: flex-end;
            }

            /* Content panels - clean solid background, no overlap */
            .content-panel {
                max-width: 100%;
                background: var(--obsidian);
                padding: 3rem 6%;
                margin: 0;
                text-align: center;
            }

            .content-panel.from-left,
            .content-panel.from-right {
                transform: translateY(30px);
                opacity: 0;
                margin: 0;
            }

            .content-panel.visible {
                transform: translateY(0);
                opacity: 1;
            }

            .content-panel.from-right {
                text-align: center;
            }

            /* Typography - clean and bold like Apple */
            .content-panel h1 {
                font-size: clamp(2.2rem, 9vw, 3rem);
                letter-spacing: -0.03em;
                margin-bottom: 1.5rem;
            }

            .content-panel h2 {
                font-size: clamp(1.8rem, 7vw, 2.4rem);
                letter-spacing: -0.02em;
                margin-bottom: 1.25rem;
            }

            .content-panel h3 {
                font-size: 1.5rem;
                margin-bottom: 1rem;
            }

            .content-panel p {
                font-size: 1rem;
                line-height: 1.6;
                color: var(--titanium);
                max-width: 320px;
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 1.5rem;
            }

            /* Eyebrow - centered */
            .hero-eyebrow {
                justify-content: center;
                margin-bottom: 0.75rem;
            }

            .hero-eyebrow::before {
                display: none;
            }

            .from-right .hero-eyebrow {
                justify-content: center;
            }

            /* Benefits list - centered and clean */
            .benefits-list {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
            }

            .benefits-list li {
                justify-content: center;
                font-size: 1rem;
                margin-bottom: 0.5rem;
            }

            .from-right .benefits-list li {
                justify-content: center;
            }

            .benefits-list li::before {
                width: 16px;
            }

            .from-right .benefits-list li::before {
                order: 0;
            }

            /* Badge - centered */
            .badge {
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 1.25rem;
            }

            /* Doctors - clean vertical stack */
            .doctors-inline {
                flex-direction: column;
                align-items: center;
                gap: 1.5rem;
                margin-top: 2rem;
            }

            .from-right .doctors-inline {
                justify-content: center;
            }

            .doctor-mini {
                flex-direction: column;
                text-align: center;
                gap: 0.75rem;
            }

            .from-right .doctor-mini {
                flex-direction: column;
            }

            .doctor-mini-avatar {
                width: 60px;
                height: 60px;
                font-size: 1.1rem;
            }

            .doctor-mini-info h4 {
                font-size: 1.1rem;
            }

            /* Doctors section - centered on mobile too */
            .section-doctors {
                justify-content: center;
            }

            .section-doctors .content-panel {
                background: transparent;
                text-align: center;
            }

            /* CTA section */
            .section-cta {
                justify-content: center;
                align-items: center;
                padding: 0;
            }

            .section-cta .content-panel {
                background: transparent;
                text-align: center;
                padding: 3rem 6%;
            }

            /* Locations - clean 2 column grid */
            .locations-mini {
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                margin-top: 2rem;
                text-align: center;
            }

            .location-mini {
                padding: 1rem;
                border-color: rgba(255, 255, 255, 0.08);
            }

            .location-mini h5 {
                font-size: 0.95rem;
            }

            /* CTA Button - larger touch target */
            .cta-button {
                padding: 1.1rem 2.5rem;
                font-size: 0.85rem;
                width: 100%;
                max-width: 280px;
                justify-content: center;
            }

            /* Scroll indicator */
            .scroll-indicator {
                bottom: 25px;
            }

            .scroll-indicator span {
                font-size: 0.6rem;
                letter-spacing: 0.25em;
            }
        }
    </style>
</head>
<body>
    <div id="loading">
        <div class="loader-wrap">
            <div class="loader-logo"><span>teamdental</span></div>
            <div class="loader"></div>
            <p class="loader-text">Loading 3D Model</p>
        </div>
    </div>

    <nav class="intro-hidden intro-from-top" id="mainNav">
        <a href="#" class="nav-logo">
            <div class="nav-logo-box"><span>teamdental</span></div>
        </a>
        <ul class="nav-links">
            <li><a href="#benefits">Benefits</a></li>
            <li><a href="#doctors">Doctors</a></li>
            <li><a href="#consultation">Book Now</a></li>
        </ul>
        <button class="nav-cta" onclick="document.getElementById('consultation').scrollIntoView({behavior: 'smooth'})">Book Now</button>
    </nav>

    <!-- Fixed 3D Canvas -->
    <div id="canvas-container"></div>

    <!-- Scroll indicator -->
    <div class="scroll-indicator" id="scrollIndicator">
        <span>Scroll to explore</span>
        <div class="scroll-arrow"></div>
    </div>

    <!-- Scroll-driven content sections -->
    <div class="scroll-container">

        <!-- Section 1: Hero - Left side -->
        <section class="scroll-section section-hero" data-rotation="0">
            <div class="content-panel from-left intro-hidden" id="heroPanel" data-animate>
                <p class="hero-eyebrow">Introducing</p>
                <h1>Facegenics<br>Midface <em>Expander</em></h1>
                <p>Revolutionary non-surgical palate expansion for adults. Experience the future of facial aesthetics.</p>
                <a href="https://teamdental.com/fme" class="cta-button">
                    Book Your Consult
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>
        </section>

        <!-- Section 2: Technology - Right side -->
        <section class="scroll-section" data-rotation="90">
            <div class="content-panel from-right" data-animate>
                <div class="badge">Now Available</div>
                <h2>FME 6-8-10<br><em>TAD System</em></h2>
                <p>Featuring Temporary Anchorage Devices for enhanced precision and predictable results. Our proprietary design delivers controlled expansion with maximum comfort.</p>
                <p style="color: var(--gold); font-size: 0.85rem;">Protraction system coming soon.</p>
            </div>
        </section>

        <!-- Section 3: Benefits - Left side -->
        <section class="scroll-section" id="benefits" data-rotation="180">
            <div class="content-panel from-left" data-animate>
                <h2>Transform<br>Your <em>Life</em></h2>
                <ul class="benefits-list">
                    <li>Wider, Fuller Smile</li>
                    <li>Improved Nasal Breathing</li>
                    <li>Relief from TMJ & Snoring</li>
                    <li>Non-Surgical Treatment</li>
                    <li>Custom-Engineered Design</li>
                </ul>
            </div>
        </section>

        <!-- Section 4: Doctors - Centered -->
        <section class="scroll-section section-doctors" id="doctors" data-rotation="270">
            <div class="content-panel from-left" data-animate>
                <p class="hero-eyebrow" style="color: #C9A962;">Your Expert Team</p>
                <h3 style="color: #C9A962;">Meet Your Doctors</h3>
                <p>Our dynamic doctor duo brings an unrivaled combination of specialized knowledge and experience.</p>
                <div class="doctors-inline">
                    <div class="doctor-mini">
                        <div class="doctor-mini-avatar">MJ</div>
                        <div class="doctor-mini-info">
                            <h4>Dr. Murtuza Jaffari</h4>
                            <span>FME Specialist</span>
                        </div>
                    </div>
                    <div class="doctor-mini">
                        <div class="doctor-mini-avatar">ZN</div>
                        <div class="doctor-mini-info">
                            <h4>Dr. Zubad Newaz</h4>
                            <span>FME Specialist</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: CTA - Center -->
        <section class="scroll-section section-cta" id="consultation" data-rotation="360">
            <div class="content-panel from-left" data-animate>
                <p class="hero-eyebrow">Ready to Transform?</p>
                <h2>Schedule Your<br><em>Consultation</em></h2>
                <p>There is no one-size-fits-all treatment. Receive a thorough, custom evaluation to know the full range of treatment options for your situation.</p>
                <a href="https://teamdental.com/fme" class="cta-button" style="margin-bottom: 2rem;">
                    Book Consultation
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
                <div class="locations-mini">
                    <div class="location-mini">
                        <h5>New York City</h5>
                        <span>212-482-1212</span>
                    </div>
                    <div class="location-mini">
                        <h5>Philadelphia</h5>
                        <span>215-598-5100</span>
                    </div>
                    <div class="location-mini">
                        <h5>Swedesboro</h5>
                        <span>856-467-4677</span>
                    </div>
                    <div class="location-mini">
                        <h5>Ponte Vedra</h5>
                        <span>904-273-9115</span>
                    </div>
                    <div class="location-mini">
                        <h5>Vermont</h5>
                        <span>802-876-7803</span>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-logo"><span>teamdental</span></div>
            <ul class="footer-links">
                <li><a href="#">Home</a></li>
                <li><a href="#">Services</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Careers</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
            <a href="object_0.glb" download="FME-3D-Model.glb" class="download-model-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7 10 12 15 17 10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download 3D Model
            </a>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 Team Dental. All rights reserved.</p>
            <p style="font-size: 0.7rem; color: rgba(138, 141, 144, 0.6);">*With accepted insurance, some restrictions apply. Individual results may vary.</p>
        </div>
    </footer>

    <!-- Three.js r170 -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

        const container = document.getElementById('canvas-container');
        const sections = document.querySelectorAll('.scroll-section');
        const panels = document.querySelectorAll('[data-animate]');
        const scrollIndicator = document.getElementById('scrollIndicator');

        // Scene setup
        const scene = new THREE.Scene();

        // Camera
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0.3, 3.5);

        // Renderer - HIGH QUALITY settings
        const renderer = new THREE.WebGLRenderer({
            antialias: true,
            alpha: true,
            powerPreference: 'high-performance',
            precision: 'highp',
            stencil: false,
            depth: true
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 3)); // Higher pixel ratio for sharper rendering
        renderer.outputColorSpace = THREE.SRGBColorSpace;
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.4;
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        container.appendChild(renderer.domElement);

        // Environment lighting
        const pmremGenerator = new THREE.PMREMGenerator(renderer);
        pmremGenerator.compileEquirectangularShader();

        // Create custom environment
        const envScene = new THREE.Scene();
        const envGeo = new THREE.SphereGeometry(50, 64, 64);
        const envMat = new THREE.ShaderMaterial({
            side: THREE.BackSide,
            uniforms: {
                uTime: { value: 0 }
            },
            vertexShader: `
                varying vec3 vWorldPosition;
                void main() {
                    vec4 worldPosition = modelMatrix * vec4(position, 1.0);
                    vWorldPosition = worldPosition.xyz;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                }
            `,
            fragmentShader: `
                varying vec3 vWorldPosition;
                void main() {
                    float h = normalize(vWorldPosition).y;
                    vec3 topColor = vec3(0.1, 0.1, 0.15);
                    vec3 midColor = vec3(0.18, 0.16, 0.14);
                    vec3 bottomColor = vec3(0.05, 0.05, 0.07);
                    vec3 color = mix(bottomColor, midColor, smoothstep(-1.0, 0.0, h));
                    color = mix(color, topColor, smoothstep(0.0, 1.0, h));

                    // Light spots
                    float spot1 = smoothstep(0.9, 1.0, dot(normalize(vWorldPosition), normalize(vec3(1.0, 1.0, 1.0))));
                    float spot2 = smoothstep(0.85, 1.0, dot(normalize(vWorldPosition), normalize(vec3(-1.0, 0.5, 0.5))));
                    float spot3 = smoothstep(0.88, 1.0, dot(normalize(vWorldPosition), normalize(vec3(0.0, -1.0, 0.5))));

                    color += vec3(1.0, 0.95, 0.85) * spot1 * 2.0;
                    color += vec3(0.7, 0.8, 0.9) * spot2 * 1.0;
                    color += vec3(0.9, 0.85, 0.8) * spot3 * 0.8;

                    gl_FragColor = vec4(color, 1.0);
                }
            `
        });
        const envMesh = new THREE.Mesh(envGeo, envMat);
        envScene.add(envMesh);

        const cubeRenderTarget = new THREE.WebGLCubeRenderTarget(2048); // High res environment map for sharp metal reflections
        const cubeCamera = new THREE.CubeCamera(0.1, 100, cubeRenderTarget);
        cubeCamera.update(renderer, envScene);
        const envMap = pmremGenerator.fromCubemap(cubeRenderTarget.texture).texture;
        scene.environment = envMap;

        // Lighting setup - tuned for brushed metal and anodized finishes
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        // Key light - warm, strong, from upper right (main highlight on metal)
        const keyLight = new THREE.DirectionalLight(0xfff5e6, 3.5);
        keyLight.position.set(3, 5, 5);
        scene.add(keyLight);

        // Fill light - softer warm tone from left
        const fillLight = new THREE.DirectionalLight(0xf0e8e0, 1.8);
        fillLight.position.set(-5, 2, 3);
        scene.add(fillLight);

        // Rim light - cool blue to bring out the blue anodized titanium
        const rimLight = new THREE.DirectionalLight(0x6BB5E8, 1.5);
        rimLight.position.set(0, 2, -5);
        scene.add(rimLight);

        // Bottom fill - subtle, prevents harsh shadows underneath
        const bottomLight = new THREE.DirectionalLight(0xffffff, 0.8);
        bottomLight.position.set(0, -5, 3);
        scene.add(bottomLight);

        // Top accent - catches the top edges of the device
        const topAccent = new THREE.DirectionalLight(0xffffff, 1.0);
        topAccent.position.set(0, 8, 0);
        scene.add(topAccent);

        // Model
        let model = null;
        const modelGroup = new THREE.Group();
        const pivotGroup = new THREE.Group(); // Handles Y rotation (trophy spin)
        const flipGroup = new THREE.Group(); // Handles upside-down flip
        flipGroup.rotation.z = Math.PI; // Flip 180 degrees upside down
        pivotGroup.add(modelGroup);
        flipGroup.add(pivotGroup);
        scene.add(flipGroup);

        // Detect mobile
        const isMobile = window.innerWidth <= 768;

        // Target rotations (controlled by scroll)
        // Model is pre-rotated to stand upright, so only Y rotation needed for spinning
        let targetRotationY = Math.PI; // Start rotated to show front face (flipped model)
        let currentRotationY = Math.PI; // Match initial pose

        // Position and zoom targets (adjusted for mobile)
        const initialZoom = isMobile ? 12.0 : 10.0;
        const initialY = isMobile ? 1.2 : 0;
        let targetPositionX = 0;
        let targetPositionY = initialY;
        let targetZoom = initialZoom;
        let currentPositionX = 0;
        let currentPositionY = initialY;
        let currentZoom = initialZoom;

        // Easing function for smooth acceleration/deceleration
        function easeInOutCubic(t) {
            return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
        }

        // Keyframes for the animation journey
        // Content layout: Hero(left), Benefits(right), Tech(left), Doctors(right), CTA(center)
        // Model moves OPPOSITE to content for visual balance
        // Model is pre-rotated to stand upright, rotY spins it around vertical axis
        // Front face offset. Slow down at content sections by having less rotation change.
        const frontFace = Math.PI; // Rotate 180 to show front face (since model is flipped)

        // Desktop keyframes - model stays at comfortable distance, gentle side-to-side
        // Front face lands on even Ï€ multiples (2, 4, 6, 8) to align with content sections
        // Content: Hero(left), Benefits(right), Tech(left), Doctors(right), CTA(center)
        // Model sits OPPOSITE side of text for visual balance
        // Model fades out after Technology section - shrinks and drifts left before Doctors
        const desktopKeyframes = [
            // Hero: model right, front face showing (text is left)
            { scroll: 0.00, x: 0.5,  y: 0,    zoom: 10.0, rotX: 0, rotY: frontFace,                  rotZ: 0 },
            { scroll: 0.10, x: 0.6,  y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 0.15, rotZ: 0 },
            // Transition: spin across to left side
            { scroll: 0.20, x: 0,    y: 0.08, zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 1.0,  rotZ: 0 },
            // TAD System: model left, front face (text is right)
            { scroll: 0.30, x: -0.6, y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 2.0,  rotZ: 0 },
            { scroll: 0.38, x: -0.55,y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 2.15, rotZ: 0 },
            // Transition: spin across to right side
            { scroll: 0.44, x: 0,    y: 0.08, zoom: 10.0, rotX: 0, rotY: frontFace + Math.PI * 3.0,  rotZ: 0 },
            // Benefits: model right, front face (text is left)
            { scroll: 0.52, x: 0.6,  y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 4.0,  rotZ: 0 },
            { scroll: 0.58, x: 0.55, y: 0,    zoom: 9.5,  rotX: 0, rotY: frontFace + Math.PI * 4.15, rotZ: 0 },
            // Exit: model shrinks and drifts left (fading out via opacity)
            { scroll: 0.64, x: -0.3, y: 0,    zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 5.0,  rotZ: 0 },
            // From here model is invisible (faded out)
            { scroll: 0.72, x: -0.4, y: 0,    zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 6.0,  rotZ: 0 },
            { scroll: 0.80, x: -0.4, y: 0,    zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 6.5,  rotZ: 0 },
            { scroll: 0.88, x: 0,    y: 0,    zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 7.0,  rotZ: 0 },
            { scroll: 1.00, x: 0,    y: 0,    zoom: 13.0, rotX: 0, rotY: frontFace + Math.PI * 8.0,  rotZ: 0 },
        ];

        // Mobile keyframes - FIXED zoom, no size changes, only rotation
        const mobileKeyframes = [
            // Fixed zoom through content sections, shrinks before doctors
            { scroll: 0.00, x: 0,    y: 1.2,   zoom: 12.0, rotX: 0, rotY: frontFace,                   rotZ: 0 },
            { scroll: 0.08, x: 0,    y: 1.1,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 0.3,   rotZ: 0 },
            { scroll: 0.15, x: 0,    y: 1.0,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 1,     rotZ: 0 },
            { scroll: 0.22, x: 0,    y: 1.0,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 2,     rotZ: 0 },
            { scroll: 0.30, x: 0,    y: 1.0,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 2,     rotZ: 0 },
            { scroll: 0.38, x: 0,    y: 1.0,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 2.3,   rotZ: 0 },
            { scroll: 0.45, x: 0,    y: 1.0,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 3,     rotZ: 0 },
            { scroll: 0.52, x: 0,    y: 1.0,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 4,     rotZ: 0 },
            { scroll: 0.58, x: 0,    y: 1.0,   zoom: 12.0, rotX: 0, rotY: frontFace + Math.PI * 4.3,   rotZ: 0 },
            // Exit: shrink before doctors section (fade handles the rest)
            { scroll: 0.64, x: 0,    y: 1.0,   zoom: 15.0, rotX: 0, rotY: frontFace + Math.PI * 5,     rotZ: 0 },
            // Faded out from here
            { scroll: 0.72, x: 0,    y: 1.0,   zoom: 16.0, rotX: 0, rotY: frontFace + Math.PI * 6,     rotZ: 0 },
            { scroll: 0.80, x: 0,    y: 1.0,   zoom: 16.0, rotX: 0, rotY: frontFace + Math.PI * 6.3,   rotZ: 0 },
            { scroll: 0.88, x: 0,    y: 1.0,   zoom: 16.0, rotX: 0, rotY: frontFace + Math.PI * 7,     rotZ: 0 },
            { scroll: 1.00, x: 0,    y: 1.0,   zoom: 16.0, rotX: 0, rotY: frontFace + Math.PI * 8,     rotZ: 0 },
        ];

        // Select keyframes based on device
        const keyframes = isMobile ? mobileKeyframes : desktopKeyframes;

        // Interpolate between keyframes
        function getInterpolatedValues(progress) {
            // Find the two keyframes we're between
            let startFrame = keyframes[0];
            let endFrame = keyframes[keyframes.length - 1];

            for (let i = 0; i < keyframes.length - 1; i++) {
                if (progress >= keyframes[i].scroll && progress <= keyframes[i + 1].scroll) {
                    startFrame = keyframes[i];
                    endFrame = keyframes[i + 1];
                    break;
                }
            }

            // Calculate local progress between these two keyframes
            const range = endFrame.scroll - startFrame.scroll;
            const localProgress = range > 0 ? (progress - startFrame.scroll) / range : 0;
            const easedProgress = easeInOutCubic(localProgress);

            // Interpolate all values
            return {
                x: startFrame.x + (endFrame.x - startFrame.x) * easedProgress,
                y: startFrame.y + (endFrame.y - startFrame.y) * easedProgress,
                zoom: startFrame.zoom + (endFrame.zoom - startFrame.zoom) * easedProgress,
                rotX: startFrame.rotX + (endFrame.rotX - startFrame.rotX) * easedProgress,
                rotY: startFrame.rotY + (endFrame.rotY - startFrame.rotY) * easedProgress,
                rotZ: startFrame.rotZ + (endFrame.rotZ - startFrame.rotZ) * easedProgress,
            };
        }

        function centerAndScaleModel(object) {
            const box = new THREE.Box3().setFromObject(object);
            const center = box.getCenter(new THREE.Vector3());
            const size = box.getSize(new THREE.Vector3());
            const maxDim = Math.max(size.x, size.y, size.z);
            const scale = 2.2 / maxDim;
            object.position.sub(center);
            object.scale.multiplyScalar(scale);
            return object;
        }

        const loader = new GLTFLoader();
        loader.load(
            'object_0.glb',
            (gltf) => {
                model = gltf.scene;

                // Enhanced material assignment based on reference photos:
                // 1. Main body: dark gunmetal gray, matte satin finish
                // 2. Frame/edges: champagne silver, brushed satin
                // 3. Blue screws/posts: deep cobalt blue anodized titanium
                // 4. Front screws: bright zinc silver, polished

                model.traverse((child) => {
                    if (child.isMesh && child.material) {
                        // Log mesh info for debugging
                        const mat = child.material;
                        const c = mat.color;
                        console.log(`Mesh: "${child.name}", Material: "${mat.name}", Color: r${c.r.toFixed(2)} g${c.g.toFixed(2)} b${c.b.toFixed(2)}, Metalness: ${mat.metalness}, Roughness: ${mat.roughness}`);

                        // Apply environment map to all
                        mat.envMap = envMap;
                        child.castShadow = true;
                        child.receiveShadow = true;

                        // Classify material by color to apply correct finish
                        const r = c.r, g = c.g, b = c.b;
                        const brightness = (r + g + b) / 3;
                        const isBlue = b > r * 1.3 && b > g * 1.1;
                        const isLight = brightness > 0.5;
                        const isDark = brightness < 0.25;

                        if (isBlue) {
                            // Blue anodized titanium screws/posts/caps
                            mat.color.setHex(0x1A3A5C); // Deep cobalt blue
                            mat.metalness = 0.85;
                            mat.roughness = 0.18;
                            mat.envMapIntensity = 1.8;
                        } else if (isLight) {
                            // Champagne silver frame/edges - brushed satin
                            mat.color.setHex(0xC0B8A8); // Warm champagne silver
                            mat.metalness = 0.92;
                            mat.roughness = 0.28;
                            mat.envMapIntensity = 1.4;
                        } else if (isDark) {
                            // Dark gunmetal gray main body - matte satin
                            mat.color.setHex(0x4A4D52); // Gunmetal gray
                            mat.metalness = 0.7;
                            mat.roughness = 0.42;
                            mat.envMapIntensity = 1.0;
                        } else {
                            // Mid-tone parts (zinc screws, etc.) - polished silver
                            mat.color.setHex(0x8A8D90); // Zinc silver
                            mat.metalness = 0.88;
                            mat.roughness = 0.2;
                            mat.envMapIntensity = 1.5;
                        }

                        mat.needsUpdate = true;
                    }
                });
                centerAndScaleModel(model);
                modelGroup.add(model);
                // Rotate modelGroup to stand upright
                // pivotGroup will then spin this on world Y axis
                // flipGroup handles the 180 degree upside-down flip
                modelGroup.rotation.x = -Math.PI * 0.5; // Stand upright
                document.getElementById('loading').classList.add('hidden');

                // Cinematic intro sequence - choreographed timing
                const navEl = document.getElementById('mainNav');
                const heroEl = document.getElementById('heroPanel');

                // 1. 3D model scales and fades in (0.3s delay)
                setTimeout(() => {
                    container.classList.add('loaded');
                }, 300);

                // 2. Nav drops down from top (0.8s delay)
                setTimeout(() => {
                    navEl.classList.remove('intro-hidden', 'intro-from-top');
                    navEl.classList.add('intro-visible');
                }, 800);

                // 3. Hero content rises into place (1.2s delay)
                setTimeout(() => {
                    heroEl.classList.remove('intro-hidden');
                    heroEl.classList.add('intro-visible', 'visible');
                }, 1200);

                // 4. Scroll indicator appears last (2.0s delay)
                setTimeout(() => {
                    scrollIndicator.classList.add('intro-ready');
                }, 2000);

                // Initial checks
                updateScrollAnimation();
                updateCanvasFade();
            },
            (progress) => {
                const percent = (progress.loaded / progress.total * 100).toFixed(0);
                document.querySelector('.loader-text').textContent = `Loading 3D Model ${percent}%`;
            },
            (error) => {
                console.error('Error loading model:', error);
                document.getElementById('loading').classList.add('hidden');
            }
        );

        // Scroll-driven animation - position, zoom, and rotation
        function updateScrollAnimation() {
            const scrollY = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollProgress = Math.min(Math.max(scrollY / docHeight, 0), 1);

            // Get interpolated values from keyframes
            const values = getInterpolatedValues(scrollProgress);

            // Set targets
            targetPositionX = values.x;
            targetPositionY = values.y;
            targetZoom = values.zoom;
            targetRotationY = values.rotY;

            // Hide scroll indicator after scrolling
            if (scrollY > 100) {
                scrollIndicator.classList.add('hidden');
            } else {
                scrollIndicator.classList.remove('hidden');
            }
        }

        // Check which panels should be visible
        // Wide threshold so content appears early and stays visible longer
        function checkPanelVisibility() {
            panels.forEach((panel) => {
                const rect = panel.getBoundingClientRect();
                // Trigger when panel enters 90% of viewport, stay visible until 10% remains
                const isVisible = rect.top < window.innerHeight * 0.9 && rect.bottom > window.innerHeight * 0.1;

                if (isVisible) {
                    panel.classList.add('visible');
                }
                // Don't remove visible class - once shown, stays shown until scroll far past
                // This prevents content from disappearing too quickly
                else if (rect.top > window.innerHeight || rect.bottom < 0) {
                    panel.classList.remove('visible');
                }
            });
        }

        // Fade out 3D model before doctors section appears
        // Uses class toggle so CSS transition handles the animation
        // Same cubic-bezier + timing as the content panels popping in
        const doctorsSection = document.getElementById('doctors');
        const ctaSection = document.getElementById('consultation');
        function updateCanvasFade() {
            if (!container.classList.contains('loaded')) return;

            const doctorsRect = doctorsSection.getBoundingClientRect();
            const viewportHeight = window.innerHeight;

            // Trigger exit only when doctors section is about to enter the viewport
            const triggerPoint = viewportHeight * 0.4;

            if (doctorsRect.top < triggerPoint) {
                container.classList.add('exit');
            } else {
                container.classList.remove('exit');
            }
        }

        // Scroll event listener
        window.addEventListener('scroll', () => {
            updateScrollAnimation();
            checkPanelVisibility();
            updateCanvasFade();
        }, { passive: true });

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);

            // Smooth interpolation for all properties (lerp factor controls smoothness)
            const lerpFactor = 0.06; // Lower = smoother/slower, Higher = snappier

            // Smooth rotation interpolation (Y axis only - trophy spin)
            currentRotationY += (targetRotationY - currentRotationY) * lerpFactor;

            // Smooth position interpolation
            currentPositionX += (targetPositionX - currentPositionX) * lerpFactor;
            currentPositionY += (targetPositionY - currentPositionY) * lerpFactor;

            // Smooth zoom interpolation
            currentZoom += (targetZoom - currentZoom) * lerpFactor;

            // Model is pre-rotated to stand upright
            // pivotGroup spins on world Y axis (trophy spin around vertical)
            pivotGroup.rotation.y = currentRotationY;

            // Apply position (model moves around the viewport)
            flipGroup.position.x = currentPositionX;

            // Apply zoom (camera distance)
            camera.position.z = currentZoom;

            // Subtle floating animation layered on top
            const time = Date.now() * 0.001;
            flipGroup.position.y = currentPositionY + Math.sin(time * 0.8) * 0.015;

            renderer.render(scene, camera);
        }

        animate();

        // Handle resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
